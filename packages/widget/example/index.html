<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kan Feedback Widget — Example</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #f8fafc;
        color: #1e293b;
        min-height: 100vh;
      }
      nav {
        background: #1e293b;
        padding: 16px 32px;
        display: flex;
        align-items: center;
        gap: 24px;
      }
      nav .logo {
        color: #fff;
        font-size: 20px;
        font-weight: 700;
      }
      nav a {
        color: #94a3b8;
        text-decoration: none;
        font-size: 14px;
      }
      nav a:hover {
        color: #e2e8f0;
      }

      .hero {
        max-width: 800px;
        margin: 60px auto;
        padding: 0 32px;
        text-align: center;
      }
      .hero h1 {
        font-size: 36px;
        margin-bottom: 16px;
      }
      .hero p {
        font-size: 18px;
        color: #64748b;
        line-height: 1.6;
      }

      .cards {
        max-width: 800px;
        margin: 40px auto;
        padding: 0 32px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
      }
      .card {
        background: #fff;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 24px;
      }
      .card h3 {
        margin-bottom: 8px;
      }
      .card p {
        font-size: 14px;
        color: #64748b;
        line-height: 1.5;
      }

      .config-panel {
        max-width: 800px;
        margin: 40px auto;
        padding: 24px 32px;
        background: #fff;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
      }
      .config-panel h2 {
        margin-bottom: 16px;
        font-size: 18px;
      }
      .config-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      .config-field {
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .config-field label {
        font-size: 12px;
        font-weight: 600;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .config-field input,
      .config-field select {
        padding: 8px 12px;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        font-size: 14px;
        font-family: monospace;
      }
      .config-actions {
        margin-top: 16px;
        display: flex;
        gap: 12px;
      }
      .config-actions button {
        padding: 8px 20px;
        border: none;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
      }
      .btn-init {
        background: #6366f1;
        color: #fff;
      }
      .btn-destroy {
        background: #f1f5f9;
        color: #64748b;
      }
      .status {
        margin-top: 12px;
        font-size: 13px;
        color: #64748b;
        font-family: monospace;
      }

      footer {
        text-align: center;
        padding: 40px;
        color: #94a3b8;
        font-size: 13px;
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="logo">Acme App</div>
      <a href="#">Dashboard</a>
      <a href="#">Settings</a>
      <a href="#">Docs</a>
    </nav>

    <div class="hero">
      <h1>Kan Feedback Widget Demo</h1>
      <p>
        This is a sample host page to test the Kan feedback widget. Configure
        your API key and board ID below, then click "Initialize Widget" to see
        the floating feedback button appear.
      </p>
    </div>

    <div class="config-panel">
      <h2>Widget Configuration</h2>
      <div class="config-grid">
        <div class="config-field">
          <label>API Key</label>
          <input id="apiKey" type="text" placeholder="kan_abc123..." />
        </div>
        <div class="config-field">
          <label>Board ID</label>
          <input id="boardId" type="text" placeholder="board public ID" />
        </div>
        <div class="config-field">
          <label>Server URL</label>
          <input id="serverUrl" type="text" value="http://localhost:4310" />
        </div>
        <div class="config-field">
          <label>Position</label>
          <select id="position">
            <option value="bottom-right">Bottom Right</option>
            <option value="bottom-left">Bottom Left</option>
            <option value="top-right">Top Right</option>
            <option value="top-left">Top Left</option>
          </select>
        </div>
        <div class="config-field">
          <label>Accent Color</label>
          <input id="accentColor" type="text" value="#6366f1" />
        </div>
        <div class="config-field">
          <label>Greeting</label>
          <input id="greeting" type="text" value="How can we help you?" />
        </div>
        <div class="config-field">
          <label>User Name</label>
          <input id="userName" type="text" placeholder="John Doe" />
        </div>
        <div class="config-field">
          <label>User Email</label>
          <input id="userEmail" type="text" placeholder="john@example.com" />
        </div>
      </div>
      <div class="config-actions">
        <button class="btn-init" onclick="initWidget()">
          Initialize Widget
        </button>
        <button class="btn-destroy" onclick="destroyWidget()">
          Destroy Widget
        </button>
      </div>
      <div class="status" id="status">Status: Not initialized</div>
    </div>

    <div class="cards">
      <div class="card">
        <h3>Feature A</h3>
        <p>
          This card exists to give the page some content to screenshot and
          annotate during testing.
        </p>
      </div>
      <div class="card">
        <h3>Feature B</h3>
        <p>
          Try placing a comment pin on this card to verify pin placement and
          numbering works correctly.
        </p>
      </div>
      <div class="card">
        <h3>Feature C</h3>
        <p>
          Use the rectangle or arrow tools to highlight issues on this card
          during annotation mode.
        </p>
      </div>
    </div>

    <footer>Kan Feedback Widget Example Page</footer>

    <script type="module">
      // Import the widget from the built file
      // When using vite dev, import from source:
      import { KanWidget } from "../src/index.ts";

      let widget = null;

      window.initWidget = function () {
        if (widget) {
          widget.destroy();
        }

        const config = {
          apiKey: document.getElementById("apiKey").value,
          boardId: document.getElementById("boardId").value,
          serverUrl: document.getElementById("serverUrl").value,
          position: document.getElementById("position").value,
          accentColor: document.getElementById("accentColor").value,
          greeting: document.getElementById("greeting").value,
          userName: document.getElementById("userName").value || undefined,
          userEmail: document.getElementById("userEmail").value || undefined,
        };

        if (!config.apiKey || !config.boardId) {
          document.getElementById("status").textContent =
            "Status: Error — API Key and Board ID are required";
          return;
        }

        widget = KanWidget.init(config);

        widget.on("open", () => {
          document.getElementById("status").textContent =
            "Status: Panel opened";
        });
        widget.on("close", () => {
          document.getElementById("status").textContent =
            "Status: Panel closed";
        });
        widget.on("submit", () => {
          document.getElementById("status").textContent =
            "Status: Feedback submitted!";
        });
        widget.on("error", () => {
          document.getElementById("status").textContent =
            "Status: Submission error";
        });

        document.getElementById("status").textContent =
          "Status: Widget initialized — click the floating button!";
      };

      window.destroyWidget = function () {
        if (widget) {
          widget.destroy();
          widget = null;
          document.getElementById("status").textContent =
            "Status: Widget destroyed";
        }
      };
    </script>
  </body>
</html>
